---
title: "Germination Experiment"
author: "Mario"
date: "07/12/2021"
output: html_document
---
Purpose:
The purpose of this experiment is to determine if cooler temperatures, as seen under shrub canopies, could be used as an indicator for the germination success of both native and exotic plant species in arid ecosystems. 

Hypothesis:
We hypothesize that fine scale temperature may be able to mediate the germination of plant individuals.

Predictions:
1) Fine scale temperature can be experimentally manipulated via heat lamps in an enclosed setting.
2) Plants will respond to varying fine scale temperatures.
3) The to temperature will be species specific.
4) Responses to temperature will vary between native and exotic plant species.

Data:
All data can be access on KNB.
https://knb.ecoinformatics.org/view/doi:10.5063/F1GQ6W6R


```{r}
###Packages for future work
library(ggmap)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(MASS)
library(ggpubr) 
library(emmeans)
```
```{r}
##Prep Temp Data
Layia <- read.csv("All Temp Data.csv")
Brome <- read.csv("Brome Temp Sheet.csv")
Salvia <- read.csv("Salvia Temp Sheet.csv")
Phacelia <- read.csv("Phacelia Temp Sheet.csv")

Temp <- merge(Layia, Brome, all = TRUE)
Temp <- merge(Temp, Salvia, all = TRUE)
Temp <- merge(Temp, Phacelia, all = TRUE)

write.csv(Temp, "Temp.csv")

###Clean up Temperature and determine the mean and max for each pendant.
Temp2 <- read.csv("Temp2.csv")

```

```{r}
#Prep Germination Data and Combine With Temp Data
Germ <- read.csv("Final Germination.csv")
final <- merge(Germ, Temp2, all = TRUE)

write.csv(final, "final.csv")
```


###Data Viz
```{r}
###Temperature vs Number of Germinated Individuals by species
TempFactor <- ggplot(final, aes(Temp, number.germinated),show.legend=FALSE) +
  geom_boxplot() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
TempFactor
```
```{r}
###Plotting the lm
plot(lm(number.germinated ~ mean_temp, data = final), which = 1)
```
```{r}
germination_poly <- lm(number.germinated ~ mean_temp + I(mean_temp^2), data = final)

library(car)
library(broom)
Anova(germination_poly)
```
```{r}
###General Figure showing Temp vs total germination (Not useable)
Temp <- ggplot(final, aes(mean_temp, number.germinated),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
Temp
```

```{r}
###Figure showing Temp vs germination by species (Not facetted)
Tempspecies <- ggplot(final, aes(mean_temp, number.germinated, color = species),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
Tempspecies
```
```{r}
###This is Temperature vs germination, facet by species. I am not the biggest fan of this figure though
TempspeciesFacet <- ggplot(final, aes(mean_temp, number.germinated, color = species),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~Temp)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
TempspeciesFacet <- TempspeciesFacet + theme(legend.title = element_text(size = 3), 
               legend.text = element_text(size = 3))
TempspeciesFacet
```


```{r}
###Plot for Temperature and germination by species
TempspeciesFacet <- ggplot(final, aes(mean_temp, number.germinated),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
TempspeciesFacet
```
```{r}
###Figure shows temperature v Germination, facet by species and filled via temperature
TempspeciesFacetColor <- ggplot(final, aes(mean_temp, number.germinated, color = Temp),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
TempspeciesFacetColor
```


```{r}
###Statistics For Germination of Each species at varying temperatures
m1 <- glm(number.germinated ~ Temp*species+mean_temp, family = "quasipoisson", data = final)
anova(m1, test = "Chisq")
###Was temp manipulated significantly in the experiment?
e1 <- emmeans(m1, pairwise~Temp)
e1

###Germination by temp and species
e2 <- emmeans(m1, pairwise~Temp|species) ###Low Temp brome germinates the same amount as Layia at all temps
e2
```
```{r}
###Difference in germination by species and temp
e3 <- emmeans(m1, pairwise~species|Temp) ###Low Temp brome germinates the same amount as Layia at all temps
e3
```


```{r}
###Mass by Temperature 
Mass <- ggplot(final, aes(mean_temp, Mass),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme() +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Mean Temperature", y = "Mass")
Mass
```
```{r}
MassSpecies <- ggplot(final, aes(mean_temp, Mass, color = species),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Mean Temperature", y = "Mass (g)")
MassSpecies
```
```{r}
MassSpeciesFacet <- ggplot(final, aes(mean_temp, Mass),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Number of Germinated Seeds")
MassSpeciesFacet
```
```{r}
###Temperature v biomass, facet by species and fill by Temp
MassSpeciesFacetColor <- ggplot(final, aes(mean_temp, Mass, color = Temp),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Temperature", y = "Biomass (g)")
MassSpeciesFacetColor
```


```{r}
###Biomass by temp and species
m2 <- glm(Mass ~ number.germinated*Temp*species+mean_temp, family = "quasipoisson", data = final)
anova(m2, test = "Chisq")
e4 <- emmeans(m2, pairwise~Temp|species)
e4

```
```{r}
###Difference in biomass by species and temp
e5 <- emmeans(m2, pairwise~species|Temp)
e5

```


---
title: "Germination Experiment"
author: "Mario"
date: "07/12/2021"
output: html_document
---
Purpose:
The purpose of this experiment is to determine if cooler temperatures, as seen under shrub canopies, could be used as an indicator for the overall germination of both native and exotic plant species in arid ecosystems. This is important as native and exotic plant species can have very different indirect effects on vertebrate animals in deserts.

Hypothesis:
Temperature will act as a direct indicator for both native and exotic species germination, thus displaying each speciesâ€™ overall success both under shrub and in open conditions.

Predictions:
1)	Higher temperatures will result in a lower germination rate of native plant species.
2)	Invasive plant species will have a higher germination rate under all temperature conditions in comparison to California Native plant species. 


```{r}
###Packages for future work
library(ggmap)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(MASS)
library(ggpubr) 
library(emmeans)
```
```{r}
##Prep Temp Data
Layia <- read.csv("All Temp Data.csv")
Brome <- read.csv("Brome Temp Sheet.csv")
Salvia <- read.csv("Salvia Temp Sheet.csv")
Phacelia <- read.csv("Phacelia Temp Sheet.csv")

Temp <- merge(Layia, Brome, all = TRUE)
Temp <- merge(Temp, Salvia, all = TRUE)
Temp <- merge(Temp, Phacelia, all = TRUE)

write.csv(Temp, "Temp.csv")

###Clean up Temperature and determine the mean and max for each pendant.
Temp2 <- read.csv("Temp2.csv")

```

```{r}
#Prep Germination Data and Combine With Temp Data
Germ <- read.csv("Final Germination.csv")
final <- merge(Germ, Temp2, all = TRUE)
```


###Data Viz
```{r}
###Factor vs Number of Germinated Individuals by species
TempFactor <- ggplot(final, aes(Factor, number.germinated),show.legend=FALSE) +
  geom_boxplot() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Factor", y = "Number of Germinated Seeds")
TempFactor
```
```{r}
Temp <- ggplot(final, aes(mean_temp, number.germinated),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Factor", y = "Number of Germinated Seeds")
Temp
```

```{r}
Tempspecies <- ggplot(final, aes(mean_temp, number.germinated, color = species),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Factor", y = "Number of Germinated Seeds")
Tempspecies
```

```{r}
###Plot for Temperature and germination by species
TempspeciesFacet <- ggplot(final, aes(mean_temp, number.germinated),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Factor", y = "Number of Germinated Seeds")
TempspeciesFacet
```

```{r}
###Statistics For Germination of Each species at varying temperatures
m1 <- glm(number.germinated ~ Factor*species+mean_temp, family = "quasipoisson", data = final)
anova(m1, test = "Chisq")
e1 <- emmeans(m1, pairwise~Factor)
e1
e2 <- emmeans(m1, pairwise~Factor:species) ###Low Temp brome germinates the same amount as Layia at all temps
e2
```
```{r}
###Mass by Temperature 
Mass <- ggplot(final, aes(mean_temp, Mass),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme() +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Mean Temperature", y = "Mass")
Mass
```
```{r}
MassSpecies <- ggplot(final, aes(mean_temp, Mass, color = species),show.legend=FALSE) +
  geom_point() +
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Mean Temperature", y = "Mass (g)")
MassSpecies
```
```{r}
MassSpeciesFacet <- ggplot(final, aes(mean_temp, Mass),show.legend=FALSE) +
  geom_point() +
  facet_wrap(~species)+
  scale_color_brewer(palette = "Set1") + theme_classic() + labs(tag = "A")+
  theme(axis.title.x = element_blank()) +
  geom_smooth(method = lm, se = TRUE) + 
  labs(x = "Factor", y = "Number of Germinated Seeds")
MassSpeciesFacet
```

```{r}
m2 <- glm(Mass ~ number.germinated*Factor*species+mean_temp, family = "quasipoisson", data = final)
anova(m2, test = "Chisq")
e3 <- emmeans(m2, pairwise~Factor:species)
e3

```

